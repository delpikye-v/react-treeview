import n,{css as e}from"styled-components";import t,{createContext as o,useContext as r,useState as i,useEffect as l,useRef as a,useLayoutEffect as d}from"react";import{HtmlUtils as c}from"@delpi/common";import s from"react-perfect-scrollbar-z";var p=function(){return p=Object.assign||function(n){for(var e,t=1,o=arguments.length;t<o;t++)for(var r in e=arguments[t])Object.prototype.hasOwnProperty.call(e,r)&&(n[r]=e[r]);return n},p.apply(this,arguments)};function f(n,e){return Object.defineProperty?Object.defineProperty(n,"raw",{value:e}):n.raw=e,n}"function"==typeof SuppressedError&&SuppressedError;var u,b,m,h,x,g,v,k,y,C,w=n.div(u||(u=f(['\n  margin-left: 30px;\n  position: relative;\n\n  > span,\n  > i {\n    min-height: 20px;\n    vertical-align: middle;\n  }\n\n  .node-data-text {\n    display: inline-block;\n    padding: 0px 5px;\n  }\n\n  .node-data-text-toggle {\n    cursor: pointer;\n  }\n\n  &::after,\n  &::before {\n    content: "";\n    left: -23px;\n    position: absolute;\n    right: auto;\n    cursor: default;\n  }\n\n  &::before {\n    border-left: ',"px dashed\n      ",";\n    bottom: 50px;\n    height: 100%;\n    top: -","px;\n    width: 1px;\n  }\n\n  &::after {\n    border-top: ","px dashed\n      ",";\n    height: 20px;\n    top: ","px;\n    width: 27px;\n  }\n\n  &:last-child::before {\n    height: ","px;\n  }\n"],['\n  margin-left: 30px;\n  position: relative;\n\n  > span,\n  > i {\n    min-height: 20px;\n    vertical-align: middle;\n  }\n\n  .node-data-text {\n    display: inline-block;\n    padding: 0px 5px;\n  }\n\n  .node-data-text-toggle {\n    cursor: pointer;\n  }\n\n  &::after,\n  &::before {\n    content: "";\n    left: -23px;\n    position: absolute;\n    right: auto;\n    cursor: default;\n  }\n\n  &::before {\n    border-left: ',"px dashed\n      ",";\n    bottom: 50px;\n    height: 100%;\n    top: -","px;\n    width: 1px;\n  }\n\n  &::after {\n    border-top: ","px dashed\n      ",";\n    height: 20px;\n    top: ","px;\n    width: 27px;\n  }\n\n  &:last-child::before {\n    height: ","px;\n  }\n"])),(function(n){return n.showYLine?1:0}),(function(n){return n.lineColor}),(function(){return 12}),(function(n){return n.showXLine?1:0}),(function(n){return n.lineColor}),(function(){return 12}),(function(){return 24})),N=n.span(x||(x=f(["\n  display: inline-block;\n  padding: 3px 7px;\n  border-radius: 6px;\n  -webkit-border-radius: 6px;\n  -moz-border-radius: 6px;\n\n  > div {\n    display: flex;\n  }\n\n  ","/* Add cursor pointer to the entire content when selectable */\n  /* &:not([disabled]) {\n    cursor: pointer;\n  } */\n\n  /* Focus outline styling for accessibility */\n  /* &:focus {\n    outline: 2px solid #007bff;\n    outline-offset: 2px;\n  } */\n"],["\n  display: inline-block;\n  padding: 3px 7px;\n  border-radius: 6px;\n  -webkit-border-radius: 6px;\n  -moz-border-radius: 6px;\n\n  > div {\n    display: flex;\n  }\n\n  ","/* Add cursor pointer to the entire content when selectable */\n  /* &:not([disabled]) {\n    cursor: pointer;\n  } */\n\n  /* Focus outline styling for accessibility */\n  /* &:focus {\n    outline: 2px solid #007bff;\n    outline-offset: 2px;\n  } */\n"])),(function(n){return n.nodeSelected&&e(h||(h=f(["\n      ","\n      ","\n        color: ",";\n    "],["\n      ","\n      ","\n        color: ",";\n    "])),n.fullRowSelection&&e(b||(b=f(["\n        background-color: ",";\n      "],["\n        background-color: ",";\n      "])),n.selectedBgColor),!n.fullRowSelection&&e(m||(m=f(["\n        .node-data-text {\n          background-color: ",";\n          border-radius: 6px;\n          -webkit-border-radius: 6px;\n          -moz-border-radius: 6px;\n        }\n      "],["\n        .node-data-text {\n          background-color: ",";\n          border-radius: 6px;\n          -webkit-border-radius: 6px;\n          -moz-border-radius: 6px;\n        }\n      "])),n.selectedBgColor),n.selectedColor)})),E=n.i(k||(k=f(['\n  display: inline-block;\n  position: relative;\n  left: 1px;\n  top: 3px;\n  cursor: pointer;\n  width: 14px;\n  height: 14px;\n\n  + .node-data-text {\n    margin-left: 2px;\n  }\n\n  &::before,\n  &::after {\n    content: "";\n    position: absolute;\n    background-color: ',";\n    transition: transform 0.25s ease-out;\n  }\n\n  /* Vertical line */\n  &::before {\n    top: 0px;\n    left: 50%;\n    width: 2px;\n    height: 100%;\n    margin-left: -1px;\n  }\n\n  /* horizontal line */\n  &::after {\n    top: 50%;\n    left: 0;\n    width: 100%;\n    height: 2px;\n    margin-top: -1px;\n  }\n\n  ","\n\n  ","\n"],['\n  display: inline-block;\n  position: relative;\n  left: 1px;\n  top: 3px;\n  cursor: pointer;\n  width: 14px;\n  height: 14px;\n\n  + .node-data-text {\n    margin-left: 2px;\n  }\n\n  &::before,\n  &::after {\n    content: "";\n    position: absolute;\n    background-color: ',";\n    transition: transform 0.25s ease-out;\n  }\n\n  /* Vertical line */\n  &::before {\n    top: 0px;\n    left: 50%;\n    width: 2px;\n    height: 100%;\n    margin-left: -1px;\n  }\n\n  /* horizontal line */\n  &::after {\n    top: 50%;\n    left: 0;\n    width: 100%;\n    height: 2px;\n    margin-top: -1px;\n  }\n\n  ","\n\n  ","\n"])),(function(n){return n.nodeSelected?n.selectedColor:"#4d6878"}),(function(n){return n.disabled&&e(g||(g=f(["\n      cursor: default;\n      pointer-events: none;\n      opacity: 0.65;\n    "],["\n      cursor: default;\n      pointer-events: none;\n      opacity: 0.65;\n    "])))}),(function(n){return n.active&&e(v||(v=f(["\n      &:before {\n        transform: rotate(90deg);\n      }\n      &:after {\n        transform: rotate(180deg);\n      }\n    "],["\n      &:before {\n        transform: rotate(90deg);\n      }\n      &:after {\n        transform: rotate(180deg);\n      }\n    "])))})),j=n.div(y||(y=f(["\n  > .rdk-tree-item:first-child {\n    &::before {\n      height: 100%;\n      top: 15px;\n    }\n  }\n  > .rdk-tree-item:only-child::before {\n    border: 0px !important;\n  }\n"],["\n  > .rdk-tree-item:first-child {\n    &::before {\n      height: 100%;\n      top: 15px;\n    }\n  }\n  > .rdk-tree-item:only-child::before {\n    border: 0px !important;\n  }\n"]))),S=n.div(C||(C=f(["\n  text-align: left;\n\n  .rdk-tree-root {\n    > .rdk-tree-item:first-child::before {\n      height: 100%;\n      top: 15px;\n    }\n\n    > .rdk-tree-item:only-child::before {\n      border: 0 !important;\n    }\n  }\n"],["\n  text-align: left;\n\n  .rdk-tree-root {\n    > .rdk-tree-item:first-child::before {\n      height: 100%;\n      top: 15px;\n    }\n\n    > .rdk-tree-item:only-child::before {\n      border: 0 !important;\n    }\n  }\n"]))),O=function(n){var e=n.checked,o=void 0!==e&&e,r=n.disabled,i=void 0!==r&&r,l=n.name,a=n.className,d=n.label,s=n.labelClassName,p=n.onChange,f=n.onLabelClick;return t.createElement("span",{className:"node-cbx"},t.createElement("input",{type:"checkbox",name:l,className:c.joinClass("node-cbx-icon",a),checked:o,disabled:i,onChange:p}),d&&t.createElement("label",{className:c.joinClass("node-cbx-label",s),onClick:f},d))},T=function(n){var e=n.children;return"function"==typeof e?t.createElement(t.Fragment,null,e()):t.createElement(t.Fragment,null,e)},L=function(n){var e=n.children;return n.isActive&&e?t.createElement("div",{className:"rdk-tree-view"},e):null},z=o({}),B=function(n){var e=n.children,o=n.id,a=n.className,d=n.iconClassName,s=n.showCheckbox,p=n.checkboxName,f=n.checkboxClassName,u=n.labelCheckboxText,b=n.labelCheckboxClassName,m=n.nodeContent,h=n.isOpen,x=void 0!==h&&h,g=n.disabled,v=void 0!==g&&g,k=n.fullRowSelection,y=void 0!==k&&k,C=n.selectedWhenToggle,j=void 0!==C&&C,S=n.selectedColor,B=void 0===S?"#000":S,P=n.selectedBgColor,R=void 0===P?"transparent":P,A=n.lineColor,I=void 0===A?"#92adc0":A,D=n.selected,F=void 0!==D&&D,H=n.hideNodeIcon,V=n.showXLine,X=void 0===V||V,Y=n.showYLine,q=void 0===Y||Y,W=n.tabIndex,G=void 0===W?0:W,J=n.selfData,K=n.onClick,M=n.onToggle,Q=(r(z)||{}).notifyToggle,U=i(x),Z=U[0],$=U[1],_=i(F),nn=_[0],en=_[1];function tn(n){null==Q||Q([!Z,n.target.closest("span.node-content")]),null==M||M(!Z,J),$(!Z)}function on(n){en(!nn),null==K||K(n,!nn,J)}function rn(n){v||(tn(n),j&&on(n))}function ln(n){!v&&j&&tn(n),on(n)}return l((function(){return en(F)}),[F]),l((function(){return $(x)}),[x]),t.createElement(w,{id:o,className:c.joinClass("rdk-tree-item",{"has-child":!!e},{"is-active":Z},a),showXLine:X,showYLine:q,lineColor:I},t.createElement(N,{className:c.joinClass("node-content",{"is-active":Z},{disabled:v},{selected:nn}),nodeSelected:nn,selectedColor:B,selectedBgColor:R,fullRowSelection:y,tabIndex:G},t.createElement("div",null,!H&&t.createElement(E,{className:c.joinClass("node-icon",d),active:Z,disabled:v,selectedColor:B,nodeSelected:nn,onClick:rn}),s&&t.createElement(O,{checked:Z,disabled:v,name:p,className:f,label:u,labelClassName:j?"node-data-text-toggle":b,onChange:rn,onLabelClick:ln}),t.createElement("span",{className:c.joinClass("node-data-text",j&&"node-data-text-toggle"),onClick:ln},t.createElement(T,null,m)))),t.createElement(L,{isActive:Z},e))},P=function(n){var e=n.children,o=n.className;return t.createElement(j,{className:c.joinClass("rdk-tree-root rdk-tree-view",o)},e)};function R(n,e,t){var o=n.element.getBoundingClientRect(),r=e.getBoundingClientRect();if(o.bottom!==r.bottom){var i,l,a,d,s=n.element.scrollTop,p=r.top-o.top;if(t){var f=p+s,u=parseInt(e.style.paddingTop||"0")||0;if(s=f-u,p/n.containerHeight<.7&&p>u)return void n.update();c.scrollTo(n.element,s,500)}else{var b=r.bottom-o.bottom;if(b<r.height&&b>0)return c.scrollTo(n.element,p+s,500),void n.update();var m=(i=n.element,l="span.node-content",a=Array.from(i.querySelectorAll(l)).reverse(),d=a.findIndex((function(n){return c.isVisible(n)})),a[d]);if(!m)return;var h=m.getBoundingClientRect(),x=o.bottom-h.top-h.height;if(x>=r.height){var g=n.element.scrollHeight-x;c.scrollTo(n.element,g,500)}else r.top<o.top&&c.scrollTo(n.element,p+s,500);n.update()}}else n.update()}var A=function(n){var e=n.children,o=n.className,r=n.effectData,l=void 0===r?[]:r,f=n.always,u=void 0===f||f,b=n.refScroll,m=function(n,e){var t={};for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&e.indexOf(o)<0&&(t[o]=n[o]);if(null!=n&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(o=Object.getOwnPropertySymbols(n);r<o.length;r++)e.indexOf(o[r])<0&&Object.prototype.propertyIsEnumerable.call(n,o[r])&&(t[o[r]]=n[o[r]])}return t}(n,["children","className","effectData","always","refScroll"]),h=a(null),x=i([]),g=x[0],v=x[1],k=i(0),y=k[0],C=k[1];d((function(){if(g){var n=g[0],e=g[1];e&&h.current&&h.current.element&&(R(h.current,e,n),b&&(b.current=h.current),C(Date.now()))}}),[g]);return t.createElement(z.Provider,{value:{notifyToggle:function(n){v(n)},flagHeight:y}},t.createElement(S,{className:"rdk-wrapper-scroll"},t.createElement(s,p({refScroll:h,effectData:l,className:c.joinClass("rdk-tree-scroll",o),always:u},m),t.createElement(P,null,e))))};export{j as StyledTreeContainer,w as StyledTreeItem,N as StyledTreeItemContent,E as StyledTreeItemIcon,S as StyledTreeScroll,B as TreeItem,A as TreeScrollView,P as TreeView,P as default};
